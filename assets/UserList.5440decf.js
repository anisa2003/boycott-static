import{_ as v,u as b,m as y,r as g,o as r,c,a as e,e as h,bv as u,bt as R,F as U,h as w,n as C,b as F,w as S,d as x,t as _,s as T,p,k as V,aR as A,aP as E,x as L}from"./index.1f24928c.js";const M={name:"UserList",data(){return{users:[],userFilter:"all",metRole:!1,toast:b()}},computed:{...y(C,["currentUser","accessToken","isAdmin","isModerator"])},async created(){await this.getUsers()},watch:{userFilter(){this.getUsers()}},methods:{async getUsers(){this.users=[],(await(await fetch("https://boycott-service.onrender.com/api/users")).json()).users.forEach(o=>{(this.userFilter=="all"||this.userFilter=="admin"&&o.roles.some(a=>a.name=="admin")||this.userFilter=="moderator"&&o.roles.some(a=>a.name=="moderator"))&&(o.roles.some(a=>a.name=="admin")?(o.role_color="red",o.role="admin"):o.roles.some(a=>a.name=="moderator")?(o.role_color="yellow",o.role="moderator"):(o.role_color="blue",o.role="user"),this.users.push(o))})},async setRole(i,l){let o=[];i=="admin"?o=["admin","moderator","user"]:i=="moderator"?o=["moderator","user"]:o=["user"];try{if((await fetch("https://boycott-service.onrender.com/api/user_roles?id="+l,{method:"PUT",headers:{"Content-type":"application/json",Authorization:"Bearer "+localStorage.accessToken,"x-access-token":localStorage.accessToken},body:JSON.stringify({roles:o})})).status==401)throw new Error("Error autorisation");this.getUsers()}catch(a){this.toast.error(a.message)}},async deleteUser(i){try{await fetch("https://boycott-service.onrender.com/api/user?id="+i,{method:"DELETE",headers:{"Content-type":"application/json",Authorization:"Bearer "+localStorage.accessToken,"x-access-token":localStorage.accessToken}}),this.getUsers()}catch(l){this.toast.error(l.message)}}}},s=i=>(A("data-v-c5c9a736"),i=i(),E(),i),B={id:"main","data-aos":"fade","data-aos-delay":"500"},I={class:"content-wrapper"},N={class:"row"},j={class:"col-12 grid-margin"},z={class:"card bg-transparent"},D={class:"card-body"},P={class:"card-title row"},q=s(()=>e("div",{class:"col"},[e("h4",null,"Utilisateurs")],-1)),J={class:"col-auto form-inline"},O={class:"form-check form-check-inline"},G=s(()=>e("label",{class:"form-check-label",for:"inlineRadio1"},"Tous",-1)),H={class:"form-check form-check-inline"},K=s(()=>e("label",{class:"form-check-label",for:"inlineRadio2"},"Mod\xE9rateurs",-1)),Q={class:"form-check form-check-inline"},W=s(()=>e("label",{class:"form-check-label",for:"inlineRadio3"},"Administrateurs",-1)),X={class:"table-responsive"},Y={class:"table text-center table-dark table-striped rounded-corners"},Z=s(()=>e("th",null,null,-1)),$=s(()=>e("th",null," Login ",-1)),ee=s(()=>e("th",null," Pays ",-1)),te=s(()=>e("th",null," R\xF4le ",-1)),oe=s(()=>e("th",null," Statut ",-1)),se=["disabled"],ie=s(()=>e("label",{for:"metRole"}," Changement de r\xF4le",-1)),le=s(()=>e("th",null,null,-1)),ae=["src"],ne={key:1,src:L,class:"img-fluid small-testimonial-img",alt:""},re={class:"fst-italic text-small"},ce={key:0},de={class:""},he={key:0,class:""},_e={class:"form-check"},me=["onChange","checked","name"],ue=s(()=>e("label",{class:"form-check-label",for:"inlineRadio1"},"Utilisateur",-1)),pe={class:"form-check"},fe=["onChange","checked","name"],ke=s(()=>e("label",{class:"form-check-label",for:"inlineRadio2"},"Moderator",-1)),ve={class:"form-check"},be=["onChange","checked","name"],ye=s(()=>e("label",{class:"form-check-label",for:"inlineRadio3"},"Administrateur",-1)),ge={key:1},Re=["onClick"],Ue=s(()=>e("i",{class:"bi bi-trash"},null,-1)),we=[Ue];function Ce(i,l,o,a,n,d){const f=g("router-link");return r(),c("main",B,[e("div",I,[e("div",N,[e("div",j,[e("div",z,[e("div",D,[e("div",P,[q,e("div",J,[e("div",O,[h(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":l[0]||(l[0]=t=>n.userFilter=t),id:"inlineRadio1",value:"all"},null,512),[[u,n.userFilter]]),G]),e("div",H,[h(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":l[1]||(l[1]=t=>n.userFilter=t),id:"inlineRadio2",value:"moderator"},null,512),[[u,n.userFilter]]),K]),e("div",Q,[h(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":l[2]||(l[2]=t=>n.userFilter=t),id:"inlineRadio3",value:"admin"},null,512),[[u,n.userFilter]]),W])])]),e("div",X,[e("table",Y,[e("thead",null,[e("tr",null,[Z,$,ee,te,oe,e("th",null,[h(e("input",{type:"checkbox","onUpdate:modelValue":l[3]||(l[3]=t=>n.metRole=t),id:"metRole",disabled:!i.isAdmin},null,8,se),[[R,n.metRole]]),ie]),le])]),e("tbody",null,[(r(!0),c(U,null,w(n.users,(t,k)=>(r(),c("tr",{key:k},[e("td",null,[t.photo?(r(),c("img",{key:0,src:"https://images.kalanso.top/"+t.photo,class:"small-testimonial-img",alt:""},null,8,ae)):(r(),c("img",ne))]),e("td",null,[F(f,{target:"_blank",to:"/profile/"+t._id},{default:S(()=>[x(_(t.login),1)]),_:2},1032,["to"])]),e("td",null,_(t.country),1),e("td",null,[e("i",{class:T(["bi bi-person-bounding-box",t.role_color])},null,2),e("p",re,_(t.role),1)]),e("td",null,_(t.status),1),n.metRole?(r(),c("td",ce,[e("div",de,[i.currentUser.id!=t._id?(r(),c("div",he,[e("div",_e,[e("input",{onChange:m=>d.setRole("user",t._id),checked:t.role=="user",class:"form-check-input",type:"radio",name:["role",t._id],id:"inlineRadio1",value:"user"},null,40,me),ue]),e("div",pe,[e("input",{onChange:m=>d.setRole("moderator",t._id),checked:t.role=="moderator",class:"form-check-input",type:"radio",name:["role",t._id],id:"inlineRadio2",value:"moderator"},null,40,fe),ke]),e("div",ve,[e("input",{onChange:m=>d.setRole("admin",t._id),checked:t.role=="admin",class:"form-check-input",type:"radio",name:["role",t._id],id:"inlineRadio3",value:"admin"},null,40,be),ye])])):p("",!0)])])):(r(),c("td",ge)),e("td",null,[i.currentUser.id!=t._id&&t.status!="Inactive"?(r(),c("a",{key:0,href:"#",onClick:V(m=>d.deleteUser(t._id),["prevent"])},we,8,Re)):p("",!0)])]))),128))])])])])])])])])])}const Se=v(M,[["render",Ce],["__scopeId","data-v-c5c9a736"]]);export{Se as default};
