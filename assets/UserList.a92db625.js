import{_ as v,u as b,m as g,r as y,o as r,c,a as e,e as h,bu as u,bs as R,F as U,g as w,l as C,b as F,w as S,d as x,t as _,q as T,n as p,j as V,aQ as A,aO as E,s as L}from"./index.9be11bf9.js";const M={name:"UserList",data(){return{users:[],userFilter:"all",metRole:!1,toast:b()}},computed:{...g(C,["currentUser","accessToken","isAdmin","isModerator"])},async created(){await this.getUsers()},watch:{userFilter(){this.getUsers()}},methods:{async getUsers(){this.users=[],(await(await fetch("https://boycott-service.onrender.com/api/users")).json()).users.forEach(o=>{(this.userFilter=="all"||this.userFilter=="admin"&&o.roles.some(a=>a.name=="admin")||this.userFilter=="moderator"&&o.roles.some(a=>a.name=="moderator"))&&(o.roles.some(a=>a.name=="admin")?(o.role_color="red",o.role="admin"):o.roles.some(a=>a.name=="moderator")?(o.role_color="yellow",o.role="moderator"):(o.role_color="blue",o.role="user"),this.users.push(o))})},async setRole(l,i){let o=[];l=="admin"?o=["admin","moderator","user"]:l=="moderator"?o=["moderator","user"]:o=["user"];try{if((await fetch("https://boycott-service.onrender.com/api/user_roles?id="+i,{method:"PUT",headers:{"Content-type":"application/json",Authorization:"Bearer "+localStorage.accessToken,"x-access-token":localStorage.accessToken},body:JSON.stringify({roles:o})})).status==401)throw new Error("Error autorisation");this.getUsers()}catch(a){this.toast.error(a.message)}},async deleteUser(l){try{await fetch("https://boycott-service.onrender.com/api/user?id="+l,{method:"DELETE",headers:{"Content-type":"application/json",Authorization:"Bearer "+localStorage.accessToken,"x-access-token":localStorage.accessToken}}),this.getUsers()}catch(i){this.toast.error(i.message)}}}},s=l=>(A("data-v-c5c9a736"),l=l(),E(),l),B={id:"main","data-aos":"fade","data-aos-delay":"500"},I={class:"content-wrapper"},N={class:"row"},j={class:"col-12 grid-margin"},q={class:"card bg-transparent"},z={class:"card-body"},D={class:"card-title row"},O=s(()=>e("div",{class:"col"},[e("h4",null,"Utilisateurs")],-1)),P={class:"col-auto form-inline"},J={class:"form-check form-check-inline"},Q=s(()=>e("label",{class:"form-check-label",for:"inlineRadio1"},"Tous",-1)),G={class:"form-check form-check-inline"},H=s(()=>e("label",{class:"form-check-label",for:"inlineRadio2"},"Mod\xE9rateurs",-1)),K={class:"form-check form-check-inline"},W=s(()=>e("label",{class:"form-check-label",for:"inlineRadio3"},"Administrateurs",-1)),X={class:"table-responsive"},Y={class:"table text-center table-dark table-striped rounded-corners"},Z=s(()=>e("th",null,null,-1)),$=s(()=>e("th",null," Login ",-1)),ee=s(()=>e("th",null," Pays ",-1)),te=s(()=>e("th",null," R\xF4le ",-1)),oe=s(()=>e("th",null," Statut ",-1)),se=["disabled"],le=s(()=>e("label",{for:"metRole"}," Changement de r\xF4le",-1)),ie=s(()=>e("th",null,null,-1)),ae=["src"],ne={key:1,src:L,class:"img-fluid small-testimonial-img",alt:""},re={class:"fst-italic text-small"},ce={key:0},de={class:""},he={key:0,class:""},_e={class:"form-check"},me=["onChange","checked","name"],ue=s(()=>e("label",{class:"form-check-label",for:"inlineRadio1"},"Utilisateur",-1)),pe={class:"form-check"},fe=["onChange","checked","name"],ke=s(()=>e("label",{class:"form-check-label",for:"inlineRadio2"},"Moderator",-1)),ve={class:"form-check"},be=["onChange","checked","name"],ge=s(()=>e("label",{class:"form-check-label",for:"inlineRadio3"},"Administrateur",-1)),ye={key:1},Re=["onClick"],Ue=s(()=>e("i",{class:"bi bi-trash"},null,-1)),we=[Ue];function Ce(l,i,o,a,n,d){const f=y("router-link");return r(),c("main",B,[e("div",I,[e("div",N,[e("div",j,[e("div",q,[e("div",z,[e("div",D,[O,e("div",P,[e("div",J,[h(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":i[0]||(i[0]=t=>n.userFilter=t),id:"inlineRadio1",value:"all"},null,512),[[u,n.userFilter]]),Q]),e("div",G,[h(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":i[1]||(i[1]=t=>n.userFilter=t),id:"inlineRadio2",value:"moderator"},null,512),[[u,n.userFilter]]),H]),e("div",K,[h(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":i[2]||(i[2]=t=>n.userFilter=t),id:"inlineRadio3",value:"admin"},null,512),[[u,n.userFilter]]),W])])]),e("div",X,[e("table",Y,[e("thead",null,[e("tr",null,[Z,$,ee,te,oe,e("th",null,[h(e("input",{type:"checkbox","onUpdate:modelValue":i[3]||(i[3]=t=>n.metRole=t),id:"metRole",disabled:!l.isAdmin},null,8,se),[[R,n.metRole]]),le]),ie])]),e("tbody",null,[(r(!0),c(U,null,w(n.users,(t,k)=>(r(),c("tr",{key:k},[e("td",null,[t.photo?(r(),c("img",{key:0,src:"https://images.kalanso.top/"+t.photo,class:"small-testimonial-img",alt:""},null,8,ae)):(r(),c("img",ne))]),e("td",null,[F(f,{target:"_blank",to:"/profile/"+t._id},{default:S(()=>[x(_(t.login),1)]),_:2},1032,["to"])]),e("td",null,_(t.country),1),e("td",null,[e("i",{class:T(["bi bi-person-bounding-box",t.role_color])},null,2),e("p",re,_(t.role),1)]),e("td",null,_(t.status),1),n.metRole?(r(),c("td",ce,[e("div",de,[l.currentUser.id!=t._id?(r(),c("div",he,[e("div",_e,[e("input",{onChange:m=>d.setRole("user",t._id),checked:t.role=="user",class:"form-check-input",type:"radio",name:["role",t._id],id:"inlineRadio1",value:"user"},null,40,me),ue]),e("div",pe,[e("input",{onChange:m=>d.setRole("moderator",t._id),checked:t.role=="moderator",class:"form-check-input",type:"radio",name:["role",t._id],id:"inlineRadio2",value:"moderator"},null,40,fe),ke]),e("div",ve,[e("input",{onChange:m=>d.setRole("admin",t._id),checked:t.role=="admin",class:"form-check-input",type:"radio",name:["role",t._id],id:"inlineRadio3",value:"admin"},null,40,be),ge])])):p("",!0)])])):(r(),c("td",ye)),e("td",null,[l.currentUser.id!=t._id&&t.status!="Inactive"?(r(),c("a",{key:0,href:"#",onClick:V(m=>d.deleteUser(t._id),["prevent"])},we,8,Re)):p("",!0)])]))),128))])])])])])])])])])}const Se=v(M,[["render",Ce],["__scopeId","data-v-c5c9a736"]]);export{Se as default};
