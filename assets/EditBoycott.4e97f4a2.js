import{h as d}from"./moment.9709ab41.js";import{V as g,I as v}from"./ImageContainer.c84ece0a.js";import{_ as D,u as Y,r as c,o as I,c as k,a as e,d as p,b as i,w as h,j as w,e as n,k as l,t as S,aQ as V,aO as M}from"./index.4f75a0b3.js";const E={name:"EditBoycott",components:{VueCtkDateTimePicker:g,ImageContainer:v},data(){return{boycottId:"",title:"",resume:"",description:"",site:"",year:"",dateStart:null,dateEnd:null,error:!1,images:[],creator:"",creatorId:"",toast:Y()}},async created(){await this.getBoycott()},methods:{async getBoycott(){this.boycottId=this.$route.params.id;try{let t=await(await fetch("https://boycott-service.onrender.com/api/boycott/"+this.boycottId)).json();this.creator=t.userId.login,this.creatorId=t.userId._id,this.title=t.title,this.description=t.description,this.resume=t.resume,this.site=t.site,this.year=t.year,this.dateStart=d(new Date(t.dateStart)).format("MM-DD-YYYY"),this.dateEnd=d(new Date(t.dateEnd)).format("MM-DD-YYYY"),this.images=t.image}catch(r){this.toast.error(r.message)}},async saveBoycott(){let r=d(this.dateStart,"MM DD YYYY"),t=d(this.dateEnd,"MM DD YYYY");try{if((await fetch("https://boycott-service.onrender.com/api/boycott?id="+this.boycottId,{method:"PUT",headers:{"Content-type":"application/json",Authorization:"Bearer "+localStorage.accessToken,"x-access-token":localStorage.accessToken},body:JSON.stringify({title:this.title,description:this.description,resume:this.resume,site:this.site,year:this.year,dateStart:r,dateEnd:t,image:this.images})})).status==401)throw new Error("Error autorisation");this.$router.push("/admin/boycotts")}catch(m){this.toast.error(m.message)}},addImage(r){this.images.push(r)}}},a=r=>(V("data-v-f8af6956"),r=r(),M(),r),x={class:"content-wrapper"},T={class:"row"},B={class:"col-12 grid-margin"},C={class:"card"},U={class:"card-body"},A=a(()=>e("h4",{class:"card-title"},"Modifier boycott",-1)),N={class:"card-description"},L={class:"form-group"},P=a(()=>e("label",{for:"title"},"Titre",-1)),R={class:"form-group"},j=a(()=>e("label",{for:"resume"},"R\xE9sum\xE9",-1)),q={class:"form-group"},O=a(()=>e("label",{for:"description"},"Description",-1)),z={class:"form-group"},J=a(()=>e("label",{for:"site"},"Site web",-1)),Q={class:"form-group"},F=a(()=>e("label",{for:"year"},"Ann\xE9e",-1)),G={class:"form-group"},H=a(()=>e("label",null,"Images",-1)),K={class:"form-group"},W=a(()=>e("label",null,"Date du d\xE9but",-1)),X={class:"form-group"},Z=a(()=>e("label",null,"Date de la fin",-1)),$=a(()=>e("button",{type:"submit",class:"btn btn-success mr-2"},"Envoyer",-1));function tt(r,t,m,et,o,u){const f=c("router-link"),y=c("ImageContainer"),_=c("VueCtkDateTimePicker"),b=c("RouterLink");return I(),k("div",x,[e("div",T,[e("div",B,[e("div",C,[e("div",U,[A,e("p",N,[p(" Cr\xE9\xE9 par "),i(f,{target:"_blank",to:"/profile/"+o.creatorId},{default:h(()=>[p(S(o.creator),1)]),_:1},8,["to"])]),e("form",{class:"forms-sample",onSubmit:t[7]||(t[7]=w((...s)=>u.saveBoycott&&u.saveBoycott(...s),["prevent"]))},[e("div",L,[P,n(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>o.title=s),class:"form-control",id:"title",placeholder:"Titre"},null,512),[[l,o.title]])]),e("div",R,[j,n(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>o.resume=s),class:"form-control",id:"resume",placeholder:"R\xE9sum\xE9"},null,512),[[l,o.resume]])]),e("div",q,[O,n(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.description=s),class:"form-control",id:"description",rows:"10"},null,512),[[l,o.description]])]),e("div",z,[J,n(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>o.site=s),class:"form-control",id:"site",placeholder:"Site web"},null,512),[[l,o.site]])]),e("div",Q,[F,n(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=s=>o.year=s),class:"form-control",id:"year",placeholder:"Ann\xE9e de cr\xE9ation"},null,512),[[l,o.year]])]),e("div",G,[H,i(y,{images:o.images,onImageAdded:u.addImage},null,8,["images","onImageAdded"])]),e("div",K,[W,i(_,{modelValue:o.dateStart,"onUpdate:modelValue":t[5]||(t[5]=s=>o.dateStart=s),id:"dateStart",format:"MM-DD-YYYY",formatted:"ll",onlyDate:"true",noLabel:"true",dark:"true",buttonNowTranslation:"Maintenant",buttonColor:"#27a776",color:"#27a776",locale:"fr"},null,8,["modelValue"])]),e("div",X,[Z,i(_,{modelValue:o.dateEnd,"onUpdate:modelValue":t[6]||(t[6]=s=>o.dateEnd=s),id:"dateEnd",format:"MM-DD-YYYY",formatted:"ll",onlyDate:"true",noLabel:"true",dark:"true",buttonNowTranslation:"Maintenant",buttonColor:"#27a776",color:"#27a776",locale:"fr"},null,8,["modelValue"])]),$,i(b,{to:"/admin/boycotts",class:"btn btn-dark"},{default:h(()=>[p("Annuler")]),_:1})],32)])])])])])}const at=D(E,[["render",tt],["__scopeId","data-v-f8af6956"]]);export{at as default};
