import{_ as p,u as m,p as g,r as b,o as c,c as a,a as t,t as n,n as d,d as o,b as y,l as f}from"./index.09bfadf6.js";import{h as v}from"./moment.9709ab41.js";import{B as w}from"./TheBoycotts.f00eaf34.js";import{_ as B}from"./boycott.abc0ad59.js";const k={name:"ProfileView",components:{Boycotts:w},data(){return{user:{},boycottsCount:{},toast:m()}},computed:{...g(f,["currentUser","accessToken","isAdmin","isModerator"])},async created(){try{let r;if(this.$route.params.userId)try{let e=await fetch("https://boycott-service.onrender.com/api/user/"+this.$route.params.userId),i=await e.json();e.status===200?(this.user=i.user,r=new Date(this.user.createdAt)):this.toast.error(i.message)}catch(e){this.toast.error(e)}else this.user=this.currentUser,this.user._id=this.user.id,r=new Date(this.currentUser.createdAt);this.user.createdAt=v(r).format("MM-DD-YYYY")}catch{this.$router.push("/")}},methods:{async onFileChange(r){try{let e=r.target.files[0],i=new FormData;i.append("image",e),i.append("imageSize",300);const h=await fetch("https://boycott-service.onrender.com/api/uploadOne",{method:"POST",headers:{"x-access-token":localStorage.accessToken},body:i}),s=await h.json();h.status==201?(this.changeAvatar(s),this.currentUser.photo="https://images.kalanso.top/"+s,localStorage.setItem("currentUser",JSON.stringify(this.currentUser)),this.user.photo="https://images.kalanso.top/"+s):this.toast.error(s.message)}catch(e){this.toast.error(e)}},async changeAvatar(r){try{let e=await fetch("https://boycott-service.onrender.com/api/updateAvatar",{method:"PUT",headers:{"x-access-token":localStorage.accessToken,"Content-type":"application/json"},body:JSON.stringify({photo:r})}),i=e.json();e.status===201?this.toast.success("Votre photo a \xE9t\xE9 modifi\xE9e"):this.toast.error(i.message)}catch(e){this.toast.error(e)}},getBoycotts(r,e){this.boycottsCount[e]=r}}},C={key:0,id:"main","data-aos":"fade","data-aos-delay":"500"},S={class:"page-header d-flex align-items-center mb-4"},A={class:"container position-relative"},I={class:"row d-flex justify-content-center"},N={class:"col-lg-6 text-center"},U={id:"about",class:"about"},j={class:"container"},x={class:"row gy-4 justify-content-center"},T={class:"col-lg-4 text-center"},V=["src"],D={key:1,src:B,class:"img-fluid",alt:""},M=["src"],P={key:2},F=t("label",{for:"upload",class:"btn-get-started mt-3"},"T\xE9l\xE9charger image",-1),O={class:"col-lg-5 content"},Y={class:"row"},q={class:"col-lg-12"},G=t("i",{class:"bi bi-chevron-right"},null,-1),J=t("strong",null,"Pays:",-1),z=t("i",{class:"bi bi-chevron-right"},null,-1),E=t("strong",null,"R\xE9gion:",-1),R=t("i",{class:"bi bi-chevron-right"},null,-1),W=t("strong",null,"Ville:",-1),H=t("i",{class:"bi bi-chevron-right"},null,-1),K=t("strong",null,"Membre depuis:",-1),L=t("i",{class:"bi bi-chevron-right"},null,-1),Q=t("strong",null,"Nombre de boycotts cr\xE9e:",-1),X=t("i",{class:"bi bi-chevron-right"},null,-1),Z=t("strong",null,"Nombre de boycotts suivis:",-1),$=t("i",{class:"bi bi-chevron-right"},null,-1),tt=t("strong",null,"Nombre d'avertissements:",-1),st={key:0,class:"container my-4"},et={class:"section-header"},ot=t("h2",null,"Mes boycotts",-1),rt={key:1,class:"container my-4"},nt={class:"section-header"},it=t("h2",null,"Boycotts que je suis",-1),lt={key:2,class:"container my-4"},ct={class:"section-header"},at=t("h2",null,"Boycotts que j'ai des avertissements",-1);function ut(r,e,i,h,s,u){const _=b("Boycotts");return s.user?(c(),a("main",C,[t("div",S,[t("div",A,[t("div",I,[t("div",N,[t("h2",null,n(s.user.login),1)])])])]),t("section",U,[t("div",j,[t("div",x,[t("div",T,[s.user.photo?(c(),a("img",{key:0,src:"https://images.kalanso.top/"+s.user.photo,class:"img-fluid",alt:""},null,8,V)):(c(),a("img",D)),t("img",{src:s.user.photo,class:"img-fluid",alt:""},null,8,M),r.currentUser&&r.currentUser.id==s.user._id?(c(),a("div",P,[F,t("input",{type:"file",id:"upload",hidden:"",onChange:e[0]||(e[0]=(...l)=>u.onFileChange&&u.onFileChange(...l))},null,32)])):d("",!0)]),t("div",O,[t("div",Y,[t("div",q,[t("ul",null,[t("li",null,[G,o(),J,o(),t("span",null,n(s.user.country),1)]),t("li",null,[z,o(),E,o(),t("span",null,n(s.user.state),1)]),t("li",null,[R,o(),W,o(),t("span",null,n(s.user.city),1)]),t("li",null,[H,o(),K,o(),t("span",null,n(s.user.createdAt),1)]),t("li",null,[L,o(),Q,o(),t("span",null,n(s.boycottsCount.all),1)]),t("li",null,[X,o(),Z,o(),t("span",null,n(s.boycottsCount.follow),1)]),t("li",null,[$,o(),tt,o(),t("span",null,n(s.boycottsCount.warn),1)])])])])])])])]),s.user._id?(c(),a("div",st,[t("div",et,[ot,t("p",null,n(s.boycottsCount.all)+" boycott(s) a(ont) \xE9t\xE9 cr\xE9\xE9(s)",1)]),y(_,{createdBy:"user",userId:s.user._id,onGetBoycotts:e[1]||(e[1]=l=>u.getBoycotts(l,"all"))},null,8,["userId"])])):d("",!0),s.user._id?(c(),a("div",rt,[t("div",nt,[it,t("p",null,n(s.boycottsCount.follow)+" boycott(s) est(sont) suivi(s)",1)]),y(_,{createdBy:"user",type:"follow",userId:s.user._id,onGetBoycotts:e[2]||(e[2]=l=>u.getBoycotts(l,"follow"))},null,8,["userId"])])):d("",!0),s.user._id?(c(),a("div",lt,[t("div",ct,[at,t("p",null,n(s.boycottsCount.warn)+" boycott(s) est(sont) avertis\xE9(s)",1)]),y(_,{createdBy:"user",type:"warn",userId:s.user._id,onGetBoycotts:e[3]||(e[3]=l=>u.getBoycotts(l,"warn"))},null,8,["userId"])])):d("",!0)])):d("",!0)}const pt=p(k,[["render",ut]]);export{pt as default};
