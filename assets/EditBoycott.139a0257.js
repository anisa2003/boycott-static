import{h as l}from"./moment.9709ab41.js";import{V as g,I as v}from"./ImageContainer.c6aa8b55.js";import{_ as D,u as Y,r as c,o as I,c as k,a as t,d as p,b as i,w as h,j as w,e as n,k as d,t as S,aQ as V,aO as M}from"./index.9be11bf9.js";const E={name:"EditBoycott",components:{VueCtkDateTimePicker:g,ImageContainer:v},data(){return{boycottId:"",title:"",resume:"",description:"",site:"",year:"",dateStart:null,dateEnd:null,error:!1,images:[],creator:"",creatorId:"",toast:Y()}},async created(){await this.getBoycott()},methods:{async getBoycott(){this.boycottId=this.$route.params.id;try{let e=await(await fetch("https://boycott-service.onrender.com/api/boycott/"+this.boycottId)).json();this.creator=e.userId.login,this.creatorId=e.userId._id,this.title=e.title,this.description=e.description,this.resume=e.resume,this.site=e.site,this.year=e.year,this.dateStart=l(new Date(e.dateStart)).format("MM-DD-YYYY"),this.dateEnd=l(new Date(e.dateEnd)).format("MM-DD-YYYY"),this.images=e.image}catch(r){this.toast.error(r.message)}},async saveBoycott(){let r=l(this.dateStart,"MM DD YYYY"),e=l(this.dateEnd,"MM DD YYYY");try{if((await fetch("https://boycott-service.onrender.com/api/boycott?id="+this.boycottId,{method:"PUT",headers:{"Content-type":"application/json",Authorization:"Bearer "+localStorage.accessToken,"x-access-token":localStorage.accessToken},body:JSON.stringify({title:this.title,description:this.description,resume:this.resume,site:this.site,year:this.year,dateStart:r,dateEnd:e,image:this.images})})).status==401)throw new Error("Error autorisation");this.$router.push("/admin/boycotts")}catch(m){this.toast.error(m.message)}},addImage(r){this.images.push(r)}}},a=r=>(V("data-v-18ee5600"),r=r(),M(),r),x={id:"main","data-aos":"fade","data-aos-delay":"500"},T={class:"content-wrapper"},B={class:"row"},C={class:"col-12 grid-margin"},U={class:"card"},A={class:"card-body"},N=a(()=>t("h4",{class:"card-title"},"Modifier boycott",-1)),L={class:"card-description"},P={class:"form-group"},R=a(()=>t("label",{for:"title"},"Titre",-1)),j={class:"form-group"},q=a(()=>t("label",{for:"resume"},"R\xE9sum\xE9",-1)),O={class:"form-group"},z=a(()=>t("label",{for:"description"},"Description",-1)),J={class:"form-group"},Q=a(()=>t("label",{for:"site"},"Site web",-1)),F={class:"form-group"},G=a(()=>t("label",{for:"year"},"Ann\xE9e",-1)),H={class:"form-group"},K=a(()=>t("label",null,"Images",-1)),W={class:"form-group"},X=a(()=>t("label",null,"Date du d\xE9but",-1)),Z={class:"form-group"},$=a(()=>t("label",null,"Date de la fin",-1)),tt=a(()=>t("button",{type:"submit",class:"btn btn-success mr-2"},"Envoyer",-1));function et(r,e,m,ot,o,u){const y=c("router-link"),f=c("ImageContainer"),_=c("VueCtkDateTimePicker"),b=c("RouterLink");return I(),k("main",x,[t("div",T,[t("div",B,[t("div",C,[t("div",U,[t("div",A,[N,t("p",L,[p(" Cr\xE9\xE9 par "),i(y,{target:"_blank",to:"/profile/"+o.creatorId},{default:h(()=>[p(S(o.creator),1)]),_:1},8,["to"])]),t("form",{class:"forms-sample",onSubmit:e[7]||(e[7]=w((...s)=>u.saveBoycott&&u.saveBoycott(...s),["prevent"]))},[t("div",P,[R,n(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>o.title=s),class:"form-control",id:"title",placeholder:"Titre"},null,512),[[d,o.title]])]),t("div",j,[q,n(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>o.resume=s),class:"form-control",id:"resume",placeholder:"R\xE9sum\xE9"},null,512),[[d,o.resume]])]),t("div",O,[z,n(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.description=s),class:"form-control",id:"description",rows:"10"},null,512),[[d,o.description]])]),t("div",J,[Q,n(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=s=>o.site=s),class:"form-control",id:"site",placeholder:"Site web"},null,512),[[d,o.site]])]),t("div",F,[G,n(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=s=>o.year=s),class:"form-control",id:"year",placeholder:"Ann\xE9e de cr\xE9ation"},null,512),[[d,o.year]])]),t("div",H,[K,i(f,{images:o.images,onImageAdded:u.addImage},null,8,["images","onImageAdded"])]),t("div",W,[X,i(_,{modelValue:o.dateStart,"onUpdate:modelValue":e[5]||(e[5]=s=>o.dateStart=s),id:"dateStart",format:"MM-DD-YYYY",formatted:"ll",onlyDate:"true",noLabel:"true",dark:"true",buttonNowTranslation:"Maintenant",buttonColor:"#27a776",color:"#27a776",locale:"fr"},null,8,["modelValue"])]),t("div",Z,[$,i(_,{modelValue:o.dateEnd,"onUpdate:modelValue":e[6]||(e[6]=s=>o.dateEnd=s),id:"dateEnd",format:"MM-DD-YYYY",formatted:"ll",onlyDate:"true",noLabel:"true",dark:"true",buttonNowTranslation:"Maintenant",buttonColor:"#27a776",color:"#27a776",locale:"fr"},null,8,["modelValue"])]),tt,i(b,{to:"/admin/boycotts",class:"btn btn-dark"},{default:h(()=>[p("Annuler")]),_:1})],32)])])])])])])}const it=D(E,[["render",et],["__scopeId","data-v-18ee5600"]]);export{it as default};
