import{_ as v,u as b,m as y,r as g,o as r,c,a as e,e as h,bu as u,bs as R,F as U,g as w,l as C,b as F,w as S,d as x,t as _,q as T,n as p,j as V,aQ as A,aO as E,s as L}from"./index.4f75a0b3.js";const M={name:"UserList",data(){return{users:[],userFilter:"all",metRole:!1,toast:b()}},computed:{...y(C,["currentUser","accessToken","isAdmin","isModerator"])},async created(){await this.getUsers()},watch:{userFilter(){this.getUsers()}},methods:{async getUsers(){this.users=[],(await(await fetch("https://boycott-service.onrender.com/api/users")).json()).users.forEach(o=>{(this.userFilter=="all"||this.userFilter=="admin"&&o.roles.some(a=>a.name=="admin")||this.userFilter=="moderator"&&o.roles.some(a=>a.name=="moderator"))&&(o.roles.some(a=>a.name=="admin")?(o.role_color="red",o.role="admin"):o.roles.some(a=>a.name=="moderator")?(o.role_color="yellow",o.role="moderator"):(o.role_color="blue",o.role="user"),this.users.push(o))})},async setRole(l,i){let o=[];l=="admin"?o=["admin","moderator","user"]:l=="moderator"?o=["moderator","user"]:o=["user"];try{if((await fetch("https://boycott-service.onrender.com/api/user_roles?id="+i,{method:"PUT",headers:{"Content-type":"application/json",Authorization:"Bearer "+localStorage.accessToken,"x-access-token":localStorage.accessToken},body:JSON.stringify({roles:o})})).status==401)throw new Error("Error autorisation");this.getUsers()}catch(a){this.toast.error(a.message)}},async deleteUser(l){try{await fetch("https://boycott-service.onrender.com/api/user?id="+l,{method:"DELETE",headers:{"Content-type":"application/json",Authorization:"Bearer "+localStorage.accessToken,"x-access-token":localStorage.accessToken}}),this.getUsers()}catch(i){this.toast.error(i.message)}}}},s=l=>(A("data-v-9d4f3478"),l=l(),E(),l),B={class:"content-wrapper"},I={class:"row"},N={class:"col-12 grid-margin"},j={class:"card"},q={class:"card-body"},z={class:"card-title row"},D=s(()=>e("div",{class:"col"},[e("h4",null,"Utilisateurs")],-1)),O={class:"col-auto form-inline"},P={class:"form-check form-check-inline"},J=s(()=>e("label",{class:"form-check-label",for:"inlineRadio1"},"Tous",-1)),Q={class:"form-check form-check-inline"},G=s(()=>e("label",{class:"form-check-label",for:"inlineRadio2"},"Mod\xE9rateurs",-1)),H={class:"form-check form-check-inline"},K=s(()=>e("label",{class:"form-check-label",for:"inlineRadio3"},"Administrateurs",-1)),W={class:"table-responsive"},X={class:"table text-center"},Y=s(()=>e("th",null,null,-1)),Z=s(()=>e("th",null," Login ",-1)),$=s(()=>e("th",null," Pays ",-1)),ee=s(()=>e("th",null," R\xF4le ",-1)),te=s(()=>e("th",null," Statut ",-1)),oe=["disabled"],se=s(()=>e("label",{for:"metRole"}," Changement de r\xF4le",-1)),le=s(()=>e("th",null,null,-1)),ie=["src"],ae={key:1,src:L,class:"img-fluid",alt:""},ne={class:"fst-italic text-small"},re={key:0},ce={class:""},de={key:0,class:""},he={class:"form-check"},_e=["onChange","checked","name"],me=s(()=>e("label",{class:"form-check-label",for:"inlineRadio1"},"Utilisateur",-1)),ue={class:"form-check"},pe=["onChange","checked","name"],fe=s(()=>e("label",{class:"form-check-label",for:"inlineRadio2"},"Moderator",-1)),ke={class:"form-check"},ve=["onChange","checked","name"],be=s(()=>e("label",{class:"form-check-label",for:"inlineRadio3"},"Administrateur",-1)),ye={key:1},ge=["onClick"],Re=s(()=>e("i",{class:"bi bi-trash"},null,-1)),Ue=[Re];function we(l,i,o,a,n,d){const f=g("router-link");return r(),c("div",B,[e("div",I,[e("div",N,[e("div",j,[e("div",q,[e("div",z,[D,e("div",O,[e("div",P,[h(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":i[0]||(i[0]=t=>n.userFilter=t),id:"inlineRadio1",value:"all"},null,512),[[u,n.userFilter]]),J]),e("div",Q,[h(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":i[1]||(i[1]=t=>n.userFilter=t),id:"inlineRadio2",value:"moderator"},null,512),[[u,n.userFilter]]),G]),e("div",H,[h(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":i[2]||(i[2]=t=>n.userFilter=t),id:"inlineRadio3",value:"admin"},null,512),[[u,n.userFilter]]),K])])]),e("div",W,[e("table",X,[e("thead",null,[e("tr",null,[Y,Z,$,ee,te,e("th",null,[h(e("input",{type:"checkbox","onUpdate:modelValue":i[3]||(i[3]=t=>n.metRole=t),id:"metRole",disabled:!l.isAdmin},null,8,oe),[[R,n.metRole]]),se]),le])]),e("tbody",null,[(r(!0),c(U,null,w(n.users,(t,k)=>(r(),c("tr",{key:k},[e("td",null,[t.photo?(r(),c("img",{key:0,src:"https://images.kalanso.top/"+t.photo,alt:""},null,8,ie)):(r(),c("img",ae))]),e("td",null,[F(f,{target:"_blank",to:"/profile/"+t._id},{default:S(()=>[x(_(t.login),1)]),_:2},1032,["to"])]),e("td",null,_(t.country),1),e("td",null,[e("i",{class:T(["bi bi-person-bounding-box",t.role_color])},null,2),e("p",ne,_(t.role),1)]),e("td",null,_(t.status),1),n.metRole?(r(),c("td",re,[e("div",ce,[l.currentUser.id!=t._id?(r(),c("div",de,[e("div",he,[e("input",{onChange:m=>d.setRole("user",t._id),checked:t.role=="user",class:"form-check-input",type:"radio",name:["role",t._id],id:"inlineRadio1",value:"user"},null,40,_e),me]),e("div",ue,[e("input",{onChange:m=>d.setRole("moderator",t._id),checked:t.role=="moderator",class:"form-check-input",type:"radio",name:["role",t._id],id:"inlineRadio2",value:"moderator"},null,40,pe),fe]),e("div",ke,[e("input",{onChange:m=>d.setRole("admin",t._id),checked:t.role=="admin",class:"form-check-input",type:"radio",name:["role",t._id],id:"inlineRadio3",value:"admin"},null,40,ve),be])])):p("",!0)])])):(r(),c("td",ye)),e("td",null,[l.currentUser.id!=t._id&&t.status!="Inactive"?(r(),c("a",{key:0,href:"#",onClick:V(m=>d.deleteUser(t._id),["prevent"])},Ue,8,ge)):p("",!0)])]))),128))])])])])])])])])}const Fe=v(M,[["render",we],["__scopeId","data-v-9d4f3478"]]);export{Fe as default};
